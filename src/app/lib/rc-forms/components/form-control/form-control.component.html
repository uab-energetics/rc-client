<div class="rc-form-control" *ngIf="_meta.visible !== false">

  <div class="rc-form-control-header">
    <ng-template #popContent>

      <ul>
        <li *ngFor="let comment of _meta.comments">{{comment}}</li>
      </ul>

      <!-- Message Input-->
      <form (ngSubmit)="addComment$.next({ key: key, comment: commentInput.value }); commentInput.value = ''" class="app-message-input" style="display: flex">
        <input #commentInput name="comment" class="message-input" style="flex-grow: 3" type="text" class="form-control mr-15"/>
        <button class="message-input-btn btn btn-primary" type="submit">Submit</button>
      </form>
      <!-- End Message Input-->
    </ng-template>

    <div>
      <h5 [ngbPopover]="popContent"
          placement="bottom"
          matTooltip="{{spec.hovertip}}"
          popoverTitle="Showing comments for {{spec.title}}" class="cursor-pointer">{{spec.title}}</h5>
      <small>{{spec.prompt}}</small>
    </div>

    <div *ngIf="spec.meta?.options?.length > 0">

      <div ngbDropdown class="d-inline-block">
        <i ngbDropdownToggle class="icon wb-settings cursor-pointer"></i> &nbsp;&nbsp;
        <div ngbDropdownMenu>
          <button (click)="reported$.next(!_meta.reported)" class="dropdown-item">Toggle Not Reported</button>
          <button (click)="visible$.next(false)" class="dropdown-item">Hide Question</button>
          <button (click)="visible$.next(false)" class="dropdown-item">Not Applicable</button>
        </div>
      </div>

    </div>
  </div>

  <div class="rc-form-control-response-body">
    <div *ngIf="_meta.reported !== false">
      <div [ngSwitch]="spec.type">
        <rc-text
          [value]="data || ''"
          [meta]="spec"
          (appChange)="responseUpdated$.next($event)"
          *ngSwitchCase="'text'">
        </rc-text>

        <rc-number
          [value]="data"
          (appChange)="responseUpdated$.next($event)"
          *ngSwitchCase="'number'">
        </rc-number>

        <rc-bool
          [value]="data"
          (appChange)="responseUpdated$.next($event)"
          *ngSwitchCase="'binary'"
          [trueOption]="spec.options[0]"
          [falseOption]="spec.options[1]">
        </rc-bool>

        <rc-select
          [value]="data"
          (appChange)="responseUpdated$.next($event)"
          *ngSwitchCase="'select'"
          [options]="spec.options">
        </rc-select>

        <rc-multi-select
          [selections]="data"
          (appChange)="responseUpdated$.next($event)"
          *ngSwitchCase="'multi-select'"
          [options]="spec.options">
        </rc-multi-select>
      </div>
    </div>

    <div *ngIf="_meta.reported === false">
      <em style="color: red">NOT REPORTED</em>
    </div>
  </div>

</div>

<div *ngIf="_meta.visible === false" style="display: flex; flex-wrap: wrap; align-items: center; justify-content: center; height: 100%; border: solid lightskyblue 2px;">
  <div class="text-center">
    <em style="color: lightskyblue">HIDDEN</em>
    <br/>
    <a (click)="visible$.next(true)" href="javascript:void(0)" class="cursor-pointer"><small>(show hidden)</small></a>
  </div>
</div>
